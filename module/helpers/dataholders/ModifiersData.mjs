const ExtrasGeneral = {
  accurate:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  affcorporeals:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  affinsubstantial:
  {
    cost: 1,
    maxranks: 2,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  affobjects:
  {
    cost: 0,
    maxranks: 1,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  affothers:
  {
    cost: 0,
    maxranks: 1,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  altresist:
  {
    cost: 0,
    maxranks: 1,
    manualpay: false,
    type: "extra",
    effect: false
  },
  area:
  {
    cost: 1,
    manualpay: true,
    type: "extra",
    effect: false
  },
  attack:
  {
    cost: 0,
    maxranks: 0,
    manualpay: false,
    type: "extra",
    effect: false
  },
  contagious:
  {
    cost: 1,
    manualpay: false,
    type: "extra",
    effect: false
  },
  dimensional:
  {
    cost: 1,
    maxranks: 3,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  extendedrange:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  feature:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  homing:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  incrduration:
  {
    cost: 1,
    manualpay: true,
    type: "extra",
    effect: false
  },
  incrmass:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  incrrange:
  {
    cost: 1,
    manualpay: true,
    type: "extra",
    effect: false
  },
  incurable:
  {
    cost: 1,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  indirect:
  {
    cost: 1,
    maxranks: 4,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  innate:
  {
    cost: 1,
    maxranks: 1,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  insidious:
  {
    cost: 1,
    maxranks: 1,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  linked:
  {
    cost: 0,
    maxranks: 0,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  multiattack:
  {
    cost: 1,
    manualpay: true,
    type: "extra",
    effect: false
  },
  penetrating:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  precise:
  {
    cost: 1,
    maxranks: 1,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  reach:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  reaction:
  {
    cost: 1,
    maxranks: 3,
    manualpay: false,
    type: "extra",
    effect: false
  },
  reversible:
  {
    cost: 1,
    maxranks: 1,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  ricochet:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  secondeffect:
  {
    cost: 1,
    manualpay: false,
    type: "extra",
    effect: false
  },
  selective:
  {
    cost: 1,
    manualpay: false,
    type: "extra",
    effect: false
  },
  sleep:
  {
    cost: 0,
    maxranks: 0,
    manualpay: false,
    type: "extra",
    effect: false
  },
  split:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  subtle:
  {
    cost: 1,
    maxranks: 2,
    manualpay: false,
    type: "extraflat",
    effect: false
  },
  sustained:
  {
    cost: 0,
    maxranks: 0,
    manualpay: false,
    type: "extra",
    effect: false
  },
  triggered:
  {
    cost: 1,
    manualpay: true,
    type: "extraflat",
    effect: false
  },
  vardescriptor:
  {
    cost: 1,
    maxranks: 2,
    manualpay: false,
    type: "extraflat",
    effect: false
  }
};

const FlawsGeneral = {
  activation: {
      cost: 1,
      maxranks: 2,
      manualpay: false,
      type: "flawsflat",
      effect: false
  },
  checkrequired: {
      cost: 1,
      manualpay: true,
      type: "flawsflat",
      effect: false
  },
  concentration: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  diminishedrange: {
      cost: 1,
      manualpay: true,
      type: "flawsflat",
      effect: false
  },
  distracting: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  fades: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  feedback: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  grabbased: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  inaccurate: {
    cost: 1,
    manualpay: true,
    type: "flawsflat",
    effect: false
},
  increasedaction: {
      cost: 1,
      maxranks: 3,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  limited: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  noticeable: {
      cost: 1,
      manualpay: false,
      type: "flawsflat",
      effect: false
  },
  permanent: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  quirk: {
      cost: 1,
      manualpay: true,
      type: "flawsflat",
      effect: false
  },
  reducedrange: {
      cost: 1,
      maxranks: 2,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  resistible: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  sensedependent: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  sideeffect: {
      cost: 1,
      maxranks: 2,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  tiring: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  uncontrolled: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  },
  unreliable: {
      cost: 1,
      manualpay: false,
      type: "flaws",
      effect: false
  }
};

const Removable = {
  removable: {
    uniquecost: 1,
    effect: true
  },
  easilyremovable: {
    uniquecost: 2,
    effect: true
  }
}

const defaultMods = {
  ...ExtrasGeneral,
  ...FlawsGeneral,
  ...Removable
};

const ExtrasSpecial = {

};

const FlawsSpecial = {

};

const specialMods = {
  ...ExtrasSpecial,
  ...FlawsSpecial
};


const allMods = {
  ...defaultMods,
  ...specialMods
};

const modIcons = {
  extra: '<i class="fa-solid fa-circle-plus"></i>',
  extraflat: '<i class="fa-solid fa-circle-plus"></i>',
  flaws: '<i class="fa-solid fa-circle-minus"></i>',
  flawsflat: '<i class="fa-solid fa-circle-minus"></i>'
}

export function fillDefaults()
{
  for(const mod in allMods)
  {
    allMods[mod].label = conf[mod] ?? null;
    allMods[mod].id = mod;
    allMods[mod].costlabel = getCostLabel(allMods[mod].type, allMods[mod].cost);
    allMods[mod].icon = modIcons[allMods[mod].type] ?? null;
  }
}

/**
 * 
 * @param {string} power_type 
 * @returns {object} 
 */
export function GetAllExtrasFlaws(power_type) {
  const conf = CONFIG.MNM3E.ExtrasFlawsAll;
  var returnModifiers = new Object();

  //var powerTypeMods = this.GetPowerModifiers(power_type);

  var returnModifiers = {
    //...powerTypeMods,
    ...defaultMods,
  }

  return returnModifiers;
}

function getCostLabel(type, cost)
{
  switch (type) {
    case 'extra':
      return `${cost}/r`;
    case 'extraflat':
      return `flat · ${cost}`;
    case 'flaws':
        return `-${cost}/r`;
    case 'flawsflat':
        return `flat · -${cost}`;
    default:
      return null;
  }
}

function getPowerModifiers(power_type)
{
  let powerModifiers = new Object();

  return powerModifiers;
}

export function getSpecificModifier(modifier)
{
  return allMods[modifier] ?? null;
}

// CustomExtrasFlaws()
// {
//   //var customExFl = game.settings.get("foundrymnm3e", "customexfl");
//   /*
//     customExFl = [
//       {
//         id: 'accurate',
//         name: 'Accurate',
//         manual_pay: false
//         type: ['','','',''] 'extraflat',
//         cost: 0,
//         maxranks: 0,
//         effect: false,
//         power_type: dropdown with none/selection from defaultPowerEffects
//       }
//     ]
//   */
//   // customExFl.forEach(element => {
//   //   var toAdd = {
//   //     type: element.type ?? 'extra',
//   //     cost: element.cost ?? 0,
//   //     manual_pay: element.manual_pay ?? false,
//   //     maxranks: element.maxranks ?? null,
//   //     effect: element.effect == '' ? false : element.effect
//   //   };

//   //   const label = element.name == '' ? element.name.charAt(0).ToUpperCase() + element.name.slice(1) : element.name;

//   //   const conf = CONFIG.MNM3E;

//   //   if (element.type == 'extra' || element.type == 'extraflat') {
//   //     toAdd.label = label;
//   //     ExtrasGeneral[element.id] = toAdd;
//   //     conf.ExtrasGeneral[element.id] = label;
//   //   }
//   //   else {
//   //     toAdd.label = label;
//   //     FlawsGeneral[element.id] = toAdd;
//   //     conf.FlawsGeneral[element.id] = label;
//   //   }
//   // });
// }